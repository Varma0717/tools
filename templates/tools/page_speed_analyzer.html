{% extends 'base.html' %}

{% block title %}
  Page Speed Analyzer - Website Performance & Speed Test Tool
{% endblock %}

{% block meta_description %}
  Test website loading speed and performance metrics. Get detailed insights on Core Web Vitals, optimization suggestions, and speed improvements.
{% endblock %}

{% block content %}
  <div class="min-h-screen bg-gray-50">
    <!-- Tool Hero Section -->
    <section class="bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 text-white py-20">
      <div class="max-w-6xl mx-auto px-6">
        <div class="text-center mb-12">
          <div class="w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-6">
            <i data-lucide="zap" class="w-10 h-10 text-white"></i>
          </div>
          <div class="flex items-center justify-center mb-4">
            <img src="{{ url_for('static', filename='favicon.png') }}" alt="Super SEO Toolkit" class="w-8 h-8 rounded-lg mr-3" />
            <h1 class="text-3xl md:text-5xl font-bold">Page Speed Analyzer</h1>
          </div>
          <p class="text-xl text-orange-100 mb-8 max-w-3xl mx-auto leading-relaxed">Measure website performance and get optimization recommendations for faster loading times</p>

          <!-- Page Speed Analyzer Form -->
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 max-w-2xl mx-auto">
            <form id="speedAnalyzerForm" class="space-y-4">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
              <div class="relative">
                <input
                  type="url"
                  name="url"
                  id="urlInput"
                  placeholder="Enter website URL (e.g., https://example.com)"
                  class="w-full px-4 py-4 bg-white text-gray-900 rounded-lg border-2 border-transparent focus:border-yellow-500 focus:outline-none text-lg"
                  required
                />
                <div class="absolute inset-y-0 right-0 flex items-center pr-4">
                  <i data-lucide="globe" class="w-5 h-5 text-gray-400"></i>
                </div>
              </div>
              <button
                type="submit"
                class="w-full bg-yellow-500 hover:bg-yellow-600 text-yellow-900 px-8 py-4 rounded-lg font-bold text-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <span class="analyze-text">
                  <i data-lucide="zap" class="w-5 h-5 inline mr-2"></i>
                  Analyze Speed
                </span>
                <span class="analyze-loader hidden">
                  <i data-lucide="loader-2" class="w-5 h-5 inline mr-2 animate-spin"></i>
                  Testing Speed...
                </span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="py-16 hidden">
      <div class="max-w-6xl mx-auto px-6">
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
          <!-- Results Header -->
          <div class="bg-gradient-to-r from-orange-600 to-red-600 text-white p-6">
            <h2 class="text-2xl font-bold mb-2">Page Speed Analysis Results</h2>
            <p class="text-orange-100">Complete performance analysis of your website</p>
          </div>

          <!-- Performance Score -->
          <div class="p-6 border-b border-gray-200">
            <div class="text-center">
              <div class="flex items-center justify-center mb-4">
                <div id="performanceScore" class="w-24 h-24 rounded-full border-8 border-gray-200 flex items-center justify-center">
                  <div class="text-center">
                    <div id="scoreValue" class="text-2xl font-bold text-gray-900">--</div>
                    <div id="scoreGrade" class="text-xs text-gray-600">--</div>
                  </div>
                </div>
              </div>
              <h3 class="text-xl font-semibold text-gray-900 mb-2">Performance Score</h3>
              <p id="scoreDescription" class="text-gray-600">Overall website performance rating</p>
            </div>
          </div>

          <!-- Key Metrics -->
          <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Key Performance Metrics</h3>
            <div class="grid md:grid-cols-4 gap-6">
              <div class="text-center">
                <div class="text-3xl font-bold text-blue-600" id="loadTime">--</div>
                <div class="text-gray-600">Load Time (s)</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-green-600" id="contentSize">--</div>
                <div class="text-gray-600">Content Size</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-purple-600" id="totalResources">--</div>
                <div class="text-gray-600">Total Resources</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-orange-600" id="statusCode">--</div>
                <div class="text-gray-600">HTTP Status</div>
              </div>
            </div>
          </div>

          <!-- Results Tabs -->
          <div class="border-b border-gray-200">
            <nav class="flex space-x-8 px-6" aria-label="Tabs">
              <button class="tab-btn border-b-2 border-orange-500 text-orange-600 py-4 px-1 font-medium text-sm" data-tab="overview">
                Overview
              </button>
              <button class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 py-4 px-1 font-medium text-sm" data-tab="resources">
                Resources
              </button>
              <button class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 py-4 px-1 font-medium text-sm" data-tab="recommendations">
                Recommendations
              </button>
              <button class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 py-4 px-1 font-medium text-sm" data-tab="tips">
                Optimization Tips
              </button>
            </nav>
          </div>

          <!-- Tab Contents -->
          <div class="p-6">
            <!-- Overview Tab -->
            <div id="overviewTab" class="tab-content">
              <div class="grid md:grid-cols-2 gap-6">
                <!-- Performance Breakdown -->
                <div class="space-y-4">
                  <h4 class="font-semibold text-gray-900">Performance Breakdown</h4>
                  
                  <div class="p-4 border border-gray-200 rounded-lg">
                    <div class="flex items-center justify-between mb-2">
                      <strong class="text-gray-900">Loading Speed</strong>
                      <span id="speedStatus" class="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs font-medium">--</span>
                    </div>
                    <div class="text-sm text-gray-600">
                      <div>Load Time: <span id="detailLoadTime" class="text-gray-900">--</span></div>
                      <div class="text-xs mt-1">Recommended: Under 3 seconds</div>
                    </div>
                  </div>

                  <div class="p-4 border border-gray-200 rounded-lg">
                    <div class="flex items-center justify-between mb-2">
                      <strong class="text-gray-900">Content Size</strong>
                      <span id="sizeStatus" class="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs font-medium">--</span>
                    </div>
                    <div class="text-sm text-gray-600">
                      <div>Size: <span id="detailContentSize" class="text-gray-900">--</span></div>
                      <div class="text-xs mt-1">Recommended: Under 1MB</div>
                    </div>
                  </div>
                </div>

                <!-- Analysis Summary -->
                <div class="space-y-4">
                  <h4 class="font-semibold text-gray-900">Analysis Summary</h4>
                  
                  <div class="p-4 border border-gray-200 rounded-lg">
                    <strong class="text-gray-900 block mb-2">Website Information</strong>
                    <div class="space-y-1 text-sm text-gray-600">
                      <div>URL: <span id="analyzedUrl" class="text-gray-900 break-all">--</span></div>
                      <div>Status: <span id="responseStatus" class="text-gray-900">--</span></div>
                      <div>Grade: <span id="performanceGrade" class="text-gray-900">--</span></div>
                    </div>
                  </div>

                  <div class="p-4 border border-gray-200 rounded-lg">
                    <strong class="text-gray-900 block mb-2">Overall Assessment</strong>
                    <p id="assessmentText" class="text-sm text-gray-600">Analysis pending...</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Resources Tab -->
            <div id="resourcesTab" class="tab-content hidden">
              <div class="space-y-6">
                <h3 class="text-lg font-semibold text-gray-900">Resource Analysis</h3>
                <div class="grid md:grid-cols-3 gap-6">
                  <div class="p-4 border border-gray-200 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600" id="imageCount">--</div>
                    <div class="text-gray-600 font-medium">Images</div>
                    <div class="text-xs text-gray-500 mt-1">Optimize for faster loading</div>
                  </div>
                  
                  <div class="p-4 border border-gray-200 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-600" id="scriptCount">--</div>
                    <div class="text-gray-600 font-medium">Scripts</div>
                    <div class="text-xs text-gray-500 mt-1">Minimize for better performance</div>
                  </div>
                  
                  <div class="p-4 border border-gray-200 rounded-lg text-center">
                    <div class="text-2xl font-bold text-purple-600" id="stylesheetCount">--</div>
                    <div class="text-gray-600 font-medium">Stylesheets</div>
                    <div class="text-xs text-gray-500 mt-1">Combine to reduce requests</div>
                  </div>
                </div>
                
                <div class="mt-6">
                  <h4 class="font-semibold text-gray-900 mb-3">Resource Recommendations</h4>
                  <div id="resourceRecommendations" class="space-y-3">
                    <!-- Dynamic content -->
                  </div>
                </div>
              </div>
            </div>

            <!-- Recommendations Tab -->
            <div id="recommendationsTab" class="tab-content hidden">
              <div class="space-y-4">
                <h3 class="text-lg font-semibold text-gray-900">Performance Recommendations</h3>
                <div id="recommendationsList" class="space-y-3">
                  <!-- Dynamic content -->
                </div>
              </div>
            </div>

            <!-- Optimization Tips Tab -->
            <div id="tipsTab" class="tab-content hidden">
              <div class="space-y-6">
                <h3 class="text-lg font-semibold text-gray-900">Speed Optimization Tips</h3>
                <div class="grid md:grid-cols-1 gap-4">
                  <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <h4 class="font-medium text-blue-900 mb-2">Image Optimization</h4>
                    <ul class="text-blue-800 text-sm space-y-1">
                      <li>• Compress images using WebP or modern formats</li>
                      <li>• Use responsive images with srcset attribute</li>
                      <li>• Implement lazy loading for images below the fold</li>
                      <li>• Optimize image dimensions for actual display size</li>
                    </ul>
                  </div>
                  
                  <div class="bg-green-50 border-l-4 border-green-400 p-4">
                    <h4 class="font-medium text-green-900 mb-2">Code Optimization</h4>
                    <ul class="text-green-800 text-sm space-y-1">
                      <li>• Minify CSS, JavaScript, and HTML files</li>
                      <li>• Remove unused CSS and JavaScript code</li>
                      <li>• Use code splitting for large JavaScript bundles</li>
                      <li>• Implement tree shaking to eliminate dead code</li>
                    </ul>
                  </div>
                  
                  <div class="bg-purple-50 border-l-4 border-purple-400 p-4">
                    <h4 class="font-medium text-purple-900 mb-2">Server Optimization</h4>
                    <ul class="text-purple-800 text-sm space-y-1">
                      <li>• Enable GZIP compression for text-based resources</li>
                      <li>• Use a Content Delivery Network (CDN)</li>
                      <li>• Optimize server response times</li>
                      <li>• Implement browser caching with proper headers</li>
                    </ul>
                  </div>
                  
                  <div class="bg-orange-50 border-l-4 border-orange-400 p-4">
                    <h4 class="font-medium text-orange-900 mb-2">Advanced Techniques</h4>
                    <ul class="text-orange-800 text-sm space-y-1">
                      <li>• Implement HTTP/2 for multiplexed connections</li>
                      <li>• Use preload hints for critical resources</li>
                      <li>• Optimize critical rendering path</li>
                      <li>• Consider service workers for caching strategies</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- How It Works -->
    <section class="py-16 bg-white">
      <div class="max-w-4xl mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">How It Works</h2>
          <p class="text-xl text-gray-600">Comprehensive performance analysis in three steps</p>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
          <div class="text-center">
            <div class="w-12 h-12 bg-orange-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-4">1</div>
            <h3 class="text-xl font-bold text-gray-900 mb-3">Enter URL</h3>
            <p class="text-gray-600">Input your website URL for performance testing</p>
          </div>

          <div class="text-center">
            <div class="w-12 h-12 bg-red-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-4">2</div>
            <h3 class="text-xl font-bold text-gray-900 mb-3">Speed Test</h3>
            <p class="text-gray-600">Our system measures loading time and analyzes resources</p>
          </div>

          <div class="text-center">
            <div class="w-12 h-12 bg-purple-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-4">3</div>
            <h3 class="text-xl font-bold text-gray-900 mb-3">Get Insights</h3>
            <p class="text-gray-600">Receive detailed performance report with optimization tips</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Features -->
    <section class="py-16">
      <div class="max-w-6xl mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Why Test Page Speed?</h2>
          <p class="text-xl text-gray-600">Fast websites perform better in search rankings and user experience</p>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <i data-lucide="trending-up" class="w-8 h-8 text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-3">Better SEO Rankings</h3>
            <p class="text-gray-600">Search engines favor fast-loading websites in their rankings</p>
          </div>

          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <i data-lucide="users" class="w-8 h-8 text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-3">Improved User Experience</h3>
            <p class="text-gray-600">Faster websites lead to higher user satisfaction and engagement</p>
          </div>

          <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <i data-lucide="dollar-sign" class="w-8 h-8 text-white"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-3">Higher Conversions</h3>
            <p class="text-gray-600">Reduced loading times result in lower bounce rates and more conversions</p>
          </div>
        </div>
      </div>
    </section>
  </div>

<script>
// HTML escape function to prevent XSS
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}


// Tab functionality
document.addEventListener('DOMContentLoaded', function() {
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const targetTab = btn.dataset.tab;
            
            // Remove active from all tabs
            tabBtns.forEach(b => {
                b.classList.remove('border-orange-500', 'text-orange-600');
                b.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Add active to clicked tab
            btn.classList.add('border-orange-500', 'text-orange-600');
            btn.classList.remove('border-transparent', 'text-gray-500');
            
            // Hide all tab contents
            tabContents.forEach(content => content.classList.add('hidden'));
            
            // Show target tab content
            document.getElementById(targetTab + 'Tab').classList.remove('hidden');
        });
    });
});

// Speed Analyzer Form Handler
document.getElementById('speedAnalyzerForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const url = document.getElementById('urlInput').value.trim();
    const submitBtn = this.querySelector('button[type="submit"]');
    const analyzeText = submitBtn.querySelector('.analyze-text');
    const analyzeLoader = submitBtn.querySelector('.analyze-loader');
    const resultsSection = document.getElementById('resultsSection');
    
    if (!url) {
        alert('Please enter a valid URL');
        return;
    }
    
    // Show loading state
    analyzeText.classList.add('hidden');
    analyzeLoader.classList.remove('hidden');
    submitBtn.disabled = true;
    
    // Hide previous results
    resultsSection.classList.add('hidden');
    
    // Make AJAX request
    fetch(window.location.pathname + '/ajax', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': document.getElementById('csrf_token').value
        },
        body: JSON.stringify({
            url: url
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            displayResults(data.results);
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        } else {
            alert('Error: ' + (data.error || 'Analysis failed'));
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Network error occurred. Please try again.');
    })
    .finally(() => {
        analyzeText.classList.remove('hidden');
        analyzeLoader.classList.add('hidden');
        submitBtn.disabled = false;
    });
});

function displayResults(data) {
    // Update performance score
    updatePerformanceScore(data);
    
    // Update key metrics
    updateKeyMetrics(data);
    
    // Update tabs
    updateOverviewTab(data);
    updateResourcesTab(data);
    updateRecommendationsTab(data);
}

function updatePerformanceScore(data) {
    const score = data.score || 0;
    const grade = data.grade || 'F';
    
    document.getElementById('scoreValue').textContent = score;
    document.getElementById('scoreGrade').textContent = grade;
    
    // Update score circle color
    const scoreElement = document.getElementById('performanceScore');
    let borderColor = 'border-red-500';
    let description = 'Poor performance - needs optimization';
    
    if (score >= 90) {
        borderColor = 'border-green-500';
        description = 'Excellent performance!';
    } else if (score >= 80) {
        borderColor = 'border-blue-500';
        description = 'Good performance';
    } else if (score >= 70) {
        borderColor = 'border-yellow-500';
        description = 'Average performance - room for improvement';
    } else if (score >= 60) {
        borderColor = 'border-orange-500';
        description = 'Below average performance';
    }
    
    scoreElement.className = `w-24 h-24 rounded-full border-8 ${borderColor} flex items-center justify-center`;
    document.getElementById('scoreDescription').textContent = description;
}

function updateKeyMetrics(data) {
    document.getElementById('loadTime').textContent = (data.load_time || 0) + 's';
    document.getElementById('contentSize').textContent = formatBytes(data.content_size);
    document.getElementById('totalResources').textContent = data.resources?.total || 0;
    document.getElementById('statusCode').textContent = data.status_code || '--';
}

function updateOverviewTab(data) {
    // Speed status
    const loadTime = data.load_time || 0;
    const speedStatus = getSpeedStatus(loadTime);
    document.getElementById('speedStatus').textContent = speedStatus.text;
    document.getElementById('speedStatus').className = getStatusClass(speedStatus.type);
    document.getElementById('detailLoadTime').textContent = loadTime + 's';
    
    // Size status
    const contentSizeKB = data.content_size_kb || 0;
    const sizeStatus = getSizeStatus(contentSizeKB);
    document.getElementById('sizeStatus').textContent = sizeStatus.text;
    document.getElementById('sizeStatus').className = getStatusClass(sizeStatus.type);
    document.getElementById('detailContentSize').textContent = formatBytes(data.content_size);
    
    // Website info
    document.getElementById('analyzedUrl').textContent = data.url || '--';
    document.getElementById('responseStatus').textContent = data.status_code || '--';
    document.getElementById('performanceGrade').textContent = data.grade || '--';
    
    // Assessment
    const assessment = generateAssessment(data);
    document.getElementById('assessmentText').textContent = assessment;
}

function updateResourcesTab(data) {
    const resources = data.resources || {};
    
    document.getElementById('imageCount').textContent = resources.images || 0;
    document.getElementById('scriptCount').textContent = resources.scripts || 0;
    document.getElementById('stylesheetCount').textContent = resources.stylesheets || 0;
    
    // Resource recommendations
    const resourceRecommendations = document.getElementById('resourceRecommendations');
    resourceRecommendations.innerHTML = '';
    
    const recommendations = generateResourceRecommendations(resources);
    recommendations.forEach(rec => {
        const div = document.createElement('div');
        div.className = `p-3 rounded-lg border-l-4 ${rec.borderColor} ${rec.bgColor}`;
        div.innerHTML = `
            <div class="font-medium ${escapeHtml(rec.textColor)}">${escapeHtml(rec.title)}</div>
            <div class="text-sm ${escapeHtml(rec.textColor)} opacity-80">${escapeHtml(rec.description)}</div>
        `;
        resourceRecommendations.appendChild(div);
    });
}

function updateRecommendationsTab(data) {
    const recommendationsList = document.getElementById('recommendationsList');
    recommendationsList.innerHTML = '';
    
    const recommendations = data.recommendations || [];
    
    if (recommendations.length === 0) {
        recommendationsList.innerHTML = `
            <div class="text-center py-8">
                <div class="text-green-600 text-4xl mb-4">🚀</div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Great Performance!</h3>
                <p class="text-gray-600">Your website is already well optimized for speed.</p>
            </div>
        `;
        return;
    }
    
    recommendations.forEach(rec => {
        const div = document.createElement('div');
        div.className = 'border-l-4 border-blue-400 bg-blue-50 p-4 rounded-r-lg';
        div.innerHTML = `
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <div class="w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs">
                        <i data-lucide="lightbulb" class="w-3 h-3"></i>
                    </div>
                </div>
                <div class="ml-3 flex-1">
                    <div class="text-sm font-medium text-blue-900">${escapeHtml(rec)}</div>
                </div>
            </div>
        `;
        recommendationsList.appendChild(div);
    });
}

// Helper Functions
function getSpeedStatus(loadTime) {
    if (loadTime <= 1) return { type: 'good', text: 'Excellent' };
    if (loadTime <= 2) return { type: 'good', text: 'Good' };
    if (loadTime <= 3) return { type: 'warning', text: 'Average' };
    return { type: 'error', text: 'Slow' };
}

function getSizeStatus(sizeKB) {
    if (sizeKB <= 100) return { type: 'good', text: 'Excellent' };
    if (sizeKB <= 500) return { type: 'good', text: 'Good' };
    if (sizeKB <= 1000) return { type: 'warning', text: 'Large' };
    return { type: 'error', text: 'Too Large' };
}

function getStatusClass(type) {
    const baseClass = 'px-2 py-1 rounded text-xs font-medium';
    switch (type) {
        case 'good': return `${baseClass} bg-green-100 text-green-800`;
        case 'warning': return `${baseClass} bg-yellow-100 text-yellow-800`;
        case 'error': return `${baseClass} bg-red-100 text-red-800`;
        default: return `${baseClass} bg-gray-100 text-gray-800`;
    }
}

function formatBytes(bytes) {
    if (!bytes) return '--';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function generateAssessment(data) {
    const score = data.score || 0;
    const loadTime = data.load_time || 0;
    
    if (score >= 90) {
        return "Excellent performance! Your website loads quickly and provides a great user experience.";
    } else if (score >= 80) {
        return "Good performance with minor room for improvement. Consider optimizing images and resources.";
    } else if (score >= 70) {
        return "Average performance. Focus on reducing load time and optimizing content size.";
    } else if (score >= 60) {
        return "Below average performance. Significant optimization needed to improve user experience.";
    } else {
        return "Poor performance detected. Immediate optimization required for better SEO and user experience.";
    }
}

function generateResourceRecommendations(resources) {
    const recommendations = [];
    
    if (resources.images > 20) {
        recommendations.push({
            title: 'Optimize Images',
            description: `${resources.images} images found. Consider compressing and using modern formats.`,
            borderColor: 'border-orange-400',
            bgColor: 'bg-orange-50',
            textColor: 'text-orange-800'
        });
    }
    
    if (resources.scripts > 10) {
        recommendations.push({
            title: 'Minimize Scripts',
            description: `${resources.scripts} script files found. Consider combining and minifying.`,
            borderColor: 'border-blue-400',
            bgColor: 'bg-blue-50',
            textColor: 'text-blue-800'
        });
    }
    
    if (resources.stylesheets > 5) {
        recommendations.push({
            title: 'Optimize Stylesheets',
            description: `${resources.stylesheets} CSS files found. Consider combining for fewer requests.`,
            borderColor: 'border-purple-400',
            bgColor: 'bg-purple-50',
            textColor: 'text-purple-800'
        });
    }
    
    if (recommendations.length === 0) {
        recommendations.push({
            title: 'Good Resource Count',
            description: 'Your resource count is optimized for good performance.',
            borderColor: 'border-green-400',
            bgColor: 'bg-green-50',
            textColor: 'text-green-800'
        });
    }
    
    return recommendations;
}

// Initialize Lucide icons
if (typeof lucide !== 'undefined') {
    lucide.createIcons();
}
</script>
{% endblock %}