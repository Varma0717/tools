{% extends "base.html" %}

{% block title %}Blog - Super SEO Toolkit{% endblock %}

{% block meta_description %}Explore expert SEO insights, tips, and case studies from Super SEO Toolkit's official blog. Boost your rankings with fresh, actionable strategies!{% endblock %}

{% block meta_keywords %}SEO tools blog, SEO tools, digital marketing, website optimization, Super SEO Toolkit{% endblock %}

{% block content %}
<section class="relative py-20 bg-white min-h-screen overflow-hidden">
  <!-- Background Accent -->
  <div aria-hidden="true" class="absolute top-[-100px] left-1/2 -translate-x-1/2 w-[600px] h-[600px] rounded-full bg-[#DAAC42]/10 blur-3xl animate-pulse"></div>

  <div class="max-w-7xl mx-auto px-6 relative z-10">
    <!-- Header Section -->
    <div class="text-center mb-16 space-y-6">
      <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight animate-fade-in-up">
        The <span class="text-[#DAAC42]">Super SEO</span> Blog
      </h1>
      <p class="text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed animate-fade-in-up">
        Stay up-to-date with the latest SEO strategies, industry insights, and comprehensive guides to help you dominate search results.
      </p>
    </div>

    <!-- Filters and Search -->
    <div class="mb-12 bg-gray-50 p-6 rounded-xl">
      <div class="flex flex-wrap gap-4 items-center justify-between">
        <!-- Search Form -->
        <form method="GET" class="flex-1 max-w-md">
          <div class="relative">
            <input type="text" name="search" value="{{ request.args.get('search', '') }}" 
                   placeholder="Search posts..." 
                   class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#DAAC42] focus:border-transparent">
            <i data-lucide="search" class="absolute left-3 top-2.5 w-4 h-4 text-gray-400"></i>
          </div>
          {% if request.args.get('category') %}
            <input type="hidden" name="category" value="{{ request.args.get('category') }}">
          {% endif %}
          {% if request.args.get('tag') %}
            <input type="hidden" name="tag" value="{{ request.args.get('tag') }}">
          {% endif %}
        </form>

        <!-- Category Filter -->
        {% if categories %}
        <div class="flex flex-wrap gap-2">
          <a href="{{ url_for('blog.blog_index') }}" 
             class="px-3 py-1 rounded-full text-sm {% if not request.args.get('category') %}bg-[#DAAC42] text-white{% else %}bg-white text-gray-700 hover:bg-gray-100{% endif %} border transition">
            All
          </a>
          {% for category in categories %}
          <a href="{{ url_for('blog.blog_index', category=category.slug) }}" 
             class="px-3 py-1 rounded-full text-sm {% if request.args.get('category') == category.slug %}bg-[#DAAC42] text-white{% else %}bg-white text-gray-700 hover:bg-gray-100{% endif %} border transition">
            {{ category.name }}
          </a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </div>
    <!-- Blog Posts Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
      {% for post in posts.items if posts.items %}
      <a href="{{ url_for('blog.view_post', slug=post.slug) }}"
         class="group flex flex-col bg-white rounded-2xl border border-gray-200 hover:border-[#DAAC42]/50 
                overflow-hidden shadow-lg hover:shadow-2xl transform hover:scale-[1.02] 
                transition-all duration-500">
        <div class="h-52 overflow-hidden relative rounded-t-2xl">
          <img src="{{ url_for('static', filename='uploads/' ~ (post.featured_image or 'default-blog.jpg')) }}"
               alt="{{ post.title }}"
               class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500 rounded-t-2xl"
               loading="lazy" />
          
          <!-- Status Badge -->
          {% if post.status == 'draft' %}
          <span class="absolute top-4 left-4 bg-yellow-500/90 text-white px-3 py-1 rounded-full text-xs font-bold uppercase shadow">
            Draft
          </span>
          {% elif post.featured %}
          <span class="absolute top-4 left-4 bg-red-500/90 text-white px-3 py-1 rounded-full text-xs font-bold uppercase shadow">
            Featured
          </span>
          {% endif %}

          <!-- Categories -->
          {% if post.categories %}
          <div class="absolute top-4 right-4 flex flex-wrap gap-1">
            {% for category in post.categories[:2] %}
            <span class="bg-[#DAAC40]/90 text-gray-900 px-2 py-1 rounded-full text-xs font-bold shadow flex items-center gap-1">
              {% if category.icon %}
              <i data-lucide="{{ category.icon }}" class="w-3 h-3"></i>
              {% endif %}
              {{ category.name }}
            </span>
            {% endfor %}
            {% if post.categories|length > 2 %}
            <span class="bg-gray-600/90 text-white px-2 py-1 rounded-full text-xs font-bold shadow">
              +{{ post.categories|length - 2 }}
            </span>
            {% endif %}
          </div>
          {% endif %}
        </div>

        <div class="p-7 flex flex-col flex-grow">
          <h2 class="text-xl font-semibold text-gray-900 mb-2 group-hover:text-[#DAAC40]
                     transition-colors duration-300 line-clamp-2">{{ post.title }}</h2>
          
          <p class="text-gray-700 text-base flex-grow line-clamp-3 mb-4">
            {{ post.excerpt or (post.content|striptags|truncate(120)) }}
          </p>

          <!-- Tags -->
          {% if post.tags %}
          <div class="flex flex-wrap gap-1 mb-4">
            {% for tag in post.tags[:3] %}
            <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">
              {{ tag.name }}
            </span>
            {% endfor %}
            {% if post.tags|length > 3 %}
            <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">
              +{{ post.tags|length - 3 }} more
            </span>
            {% endif %}
          </div>
          {% endif %}

          <div class="flex items-center mt-auto justify-between">
            <div class="flex items-center gap-2">
              <!-- Author SVG Icon -->
              <div class="w-7 h-7 bg-[#DAAC42]/20 rounded-full flex items-center justify-center">
                <svg class="w-4 h-4 text-[#DAAC42]" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                </svg>
              </div>
              <span class="text-sm font-medium text-gray-700">{{ post.display_author or "Super SEO Toolkit" }}</span>
            </div>
            <div class="text-right">
              <time class="text-xs text-gray-400 block">
                {{ post.published_at.strftime('%b %d, %Y') if post.published_at else post.created_at.strftime('%b %d, %Y') }}
              </time>
              {% if post.view_count %}
              <span class="text-xs text-gray-400 flex items-center gap-1 mt-1">
                <i data-lucide="eye" class="w-3 h-3"></i>
                {{ post.view_count }}
              </span>
              {% endif %}
            </div>
          </div>
        </div>
      </a>
      {% else %}
      <div class="col-span-full py-24 text-center">
        <div class="max-w-md mx-auto">
          <i data-lucide="file-text" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
          <h3 class="text-xl font-medium text-gray-600 mb-2">No posts found</h3>
          <p class="text-gray-400">
            {% if request.args.get('search') or request.args.get('category') or request.args.get('tag') %}
              Try adjusting your filters or search terms.
            {% else %}
              Check back soon for new content!
            {% endif %}
          </p>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if posts.pages > 1 %}
    <nav class="flex justify-center items-center space-x-2" aria-label="Pagination">
      {% if posts.has_prev %}
        <a href="{{ url_for('blog.blog_index', page=posts.prev_num, **request.args) }}" 
           class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700">
          Previous
        </a>
      {% endif %}

      {% for page_num in posts.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
          {% if page_num != posts.page %}
            <a href="{{ url_for('blog.blog_index', page=page_num, **request.args) }}" 
               class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700">
              {{ page_num }}
            </a>
          {% else %}
            <span class="px-3 py-2 text-sm font-medium text-white bg-[#DAAC42] border border-[#DAAC42] rounded-md">
              {{ page_num }}
            </span>
          {% endif %}
        {% else %}
          <span class="px-3 py-2 text-sm font-medium text-gray-500">â€¦</span>
        {% endif %}
      {% endfor %}

      {% if posts.has_next %}
        <a href="{{ url_for('blog.blog_index', page=posts.next_num, **request.args) }}" 
           class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 hover:text-gray-700">
          Next
        </a>
      {% endif %}
    </nav>
    {% endif %}
  </div>
</section>

<script>
  // Initialize Lucide icons and fade-in animation
  document.addEventListener('DOMContentLoaded', () => {
    if (window.lucide) {
      window.lucide.createIcons();
    }
    
    // Simple fade-in animation for header
    document.querySelectorAll('.animate-fade-in-up').forEach(el => {
      el.style.opacity = 0;
      el.style.transform = 'translateY(20px)';
      setTimeout(() => {
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        el.style.opacity = 1;
        el.style.transform = 'translateY(0)';
      }, 100);
    });

    // Auto-submit search form on input (with debounce)
    const searchInput = document.querySelector('input[name="search"]');
    if (searchInput) {
      let timeout;
      searchInput.addEventListener('input', function() {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          this.form.submit();
        }, 500);
      });
    }
  });
</script>
{% endblock %}
