"""
Main blueprint initialization.
"""

from .routes import main_bp

__all__ = ['main_bp']


@main_bp.route("/")
def home():
    """Homepage route."""
    # Fetch recent posts from database
    recent_posts_db = Post.query.order_by(Post.created_at.desc()).limit(3).all()

    # Format posts for template
    recent_posts = []
    for post in recent_posts_db:
        recent_posts.append(
            {
                "title": post.title,
                "slug": post.slug,
                "summary": post.summary or (post.content[:120] + "..."),
                "image": post.image,
            }
        )

    # Static data (consider moving to database)
    testimonials = [
        {
            "name": "Neha Sharma",
            "company": "Growth Labs",
            "message": "Super SEO Toolkit made my website audits a breeze! The AI suggestions are spot on and easy to implement.",
        },
        {
            "name": "David Lee",
            "company": "WebRise Agency",
            "message": "The dashboard is modern and intuitive. I especially love the real-time reports and downloadable PDFs for my clients.",
        },
        {
            "name": "Priya Verma",
            "company": "Freelance SEO",
            "message": "Keyword and backlink tools are super accurate. My site's performance improved within weeks. Highly recommended!",
        },
    ]

    faqs = [
        {
            "question": "Is Super SEO Toolkit free to use?",
            "answer": "Yes! Most tools are free. Some advanced features require a premium plan for unlimited usage.",
        },
        {
            "question": "Do I need to register to use the tools?",
            "answer": "You can use most tools without an account. Registration gives you access to history, reports, and premium tools.",
        },
        {
            "question": "Are my website scans private?",
            "answer": "Absolutely. Your data and reports are confidential and visible only to you in your account dashboard.",
        },
        {
            "question": "Can I download PDF reports?",
            "answer": "Yes, you can generate and download detailed PDF reports for all audits and checks.",
        },
        {
            "question": "Do you support WordPress, Shopify, and custom sites?",
            "answer": "Yes! Our tools work for all popular platforms including WordPress, Shopify, Magento, HTML, and more.",
        },
    ]

    categories = [
        {"name": "Meta Tags Tools", "slug": "meta-tags-tools", "icon": "tag"},
        {
            "name": "AI Writing Generators",
            "slug": "ai-writing-generators",
            "icon": "pen-tool",
        },
        {
            "name": "Website Management Tools",
            "slug": "website-management-tools",
            "icon": "settings",
        },
        {"name": "Keyword Tools", "slug": "keyword-tools", "icon": "search"},
        {"name": "Backlink Tools", "slug": "backlink-tools", "icon": "link"},
        {"name": "PDF Tools", "slug": "pdf-tools", "icon": "file-text"},
        {"name": "Domain Tools", "slug": "domain-tools", "icon": "globe"},
        {"name": "Image Tools", "slug": "image-tools", "icon": "image"},
    ]

    return render_template(
        "home.html",
        recent_posts=recent_posts,
        testimonials=testimonials,
        faqs=faqs,
        categories=categories,
    )


@main_bp.route("/pricing")
def pricing():
    """Pricing page route."""
    return render_template("pricing.html")


@main_bp.route("/privacy-policy")
def privacy():
    """Privacy policy page."""
    return render_template("privacy.html")


@main_bp.route("/terms-and-conditions")
def terms():
    """Terms and conditions page."""
    return render_template("terms.html")


@main_bp.route("/cookies-policy")
def cookies():
    """Cookies policy page."""
    return render_template("cookies.html")


@main_bp.route("/about-us")
def about_us():
    """About us page."""
    return render_template("about.html")
